nn, nr, rn and rr versions are the same except for ordering of neighbors and vertices
s1 and s2 are shuffled
